<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
			crossorigin="anonymous"
		/>
		<link rel="stylesheet" href="css/style.css" />
		<title>Admin</title>
	</head>
	<body class="d-flex align-items-center vh-100 flex-column">
		<div
			class="border-5 border border-warning w-75 d-flex flex-column"
			style="margin-top: 150px; border-radius: 20px"
		>
			<div class="bg-warning p-4">
				<h1>Sistem Antrian</h1>
			</div>
			<div class="p-4">
				<ul class="nav nav-tabs" id="myTab" role="tablist">
					<li class="nav-item" role="presentation">
						<button
							class="nav-link active"
							id="home-tab"
							data-bs-toggle="tab"
							data-bs-target="#home"
							type="button"
							role="tab"
							aria-controls="home"
							aria-selected="true"
						>
							Loket 1
						</button>
					</li>
					<li class="nav-item" role="presentation">
						<button
							class="nav-link"
							id="profile-tab"
							data-bs-toggle="tab"
							data-bs-target="#profile"
							type="button"
							role="tab"
							aria-controls="profile"
							aria-selected="false"
						>
							Loket 2
						</button>
					</li>
				</ul>
			</div>
			<div class="tab-content" id="myTabContent">
				<div
					class="tab-pane fade show active"
					id="home"
					role="tabpanel"
					aria-labelledby="home-tab"
				>
					<div
						class="d-flex align-items-center justify-content-center flex-column gap-4 p-4"
					>
						<h2>Loket 1</h2>
						<div
							class="rounded rounded-3 bg-warning d-flex justify-content-center align-items-center gap-4 flex-column p-4"
						>
							<h1 class="fw-bold">Antrian</h1>
							<p id="loket1" class="count">0</p>
						</div>
						<div class="d-flex gap-4">
							<button class="btn btn-danger" onclick="actionPrev(1)">
								prev
							</button>
							<button class="btn btn-primary" onclick="actionNext(1)">
								next
							</button>
						</div>
					</div>
				</div>
				<div
					class="tab-pane fade"
					id="profile"
					role="tabpanel"
					aria-labelledby="profile-tab"
				>
					<div
						class="d-flex align-items-center justify-content-center flex-column gap-4 p-4"
					>
						<h2>Loket 2</h2>
						<div
							class="rounded rounded-3 bg-warning d-flex justify-content-center align-items-center gap-4 flex-column p-4"
						>
							<h1 class="fw-bold">Antrian</h1>
							<p id="loket2" class="count">0</p>
						</div>
						<div class="d-flex gap-4">
							<button class="btn btn-danger" onclick="actionPrev(2)">
								prev
							</button>
							<button class="btn btn-primary" onclick="actionNext(2)">
								next
							</button>
						</div>
					</div>
				</div>
				<div
					class="tab-pane fade"
					id="contact"
					role="tabpanel"
					aria-labelledby="contact-tab"
				>
					...
				</div>
			</div>
		</div>
	</body>
	<script>
		//connection ws
		const socket = new WebSocket('ws://localhost:8080');
		socket.addEventListener('open', (e) => {
			console.log('admin connected to server ws');
		});

		// listen for message
		const loket1 = document.getElementById('loket1');
		socket.addEventListener('message', (e) => {
			const data = JSON.parse(e.data);
			loket1.innerText = data?.queue1;
			loket2.innerText = data?.queue2;
		});

		const actionNext = (loket) => {
			socket.send(`next${loket}`);
		};

		const actionPrev = (loket) => {
			socket.send(`prev${loket}`);
		};
	</script>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
		crossorigin="anonymous"
	></script>
</html>
